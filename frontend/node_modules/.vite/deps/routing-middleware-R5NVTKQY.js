import {
  __commonJS,
  __toESM
} from "./chunk-LK32TJAX.js";

// node_modules/@segment/analytics-next/dist/pkg/vendor/tsub/tsub.js
var require_tsub = __commonJS({
  "node_modules/@segment/analytics-next/dist/pkg/vendor/tsub/tsub.js"(exports, module) {
    "use strict";
    !function(t, r) {
      if ("object" == typeof exports && "object" == typeof module)
        module.exports = r();
      else if ("function" == typeof define && define.amd)
        define([], r);
      else {
        var e = r();
        for (var n in e)
          ("object" == typeof exports ? exports : t)[n] = e[n];
      }
    }(self, function() {
      return function() {
        var t = { 2870: function(t2, r2, e2) {
          "use strict";
          var n = this && this.__importDefault || function(t3) {
            return t3 && t3.__esModule ? t3 : { default: t3 };
          };
          Object.defineProperty(r2, "__esModule", { value: true }), r2.Store = r2.matches = r2.transform = void 0;
          var o = e2(4303);
          Object.defineProperty(r2, "transform", { enumerable: true, get: function() {
            return n(o).default;
          } });
          var s = e2(2370);
          Object.defineProperty(r2, "matches", { enumerable: true, get: function() {
            return n(s).default;
          } });
          var i = e2(1444);
          Object.defineProperty(r2, "Store", { enumerable: true, get: function() {
            return n(i).default;
          } });
        }, 2370: function(t2, r2, e2) {
          "use strict";
          var n = this && this.__importDefault || function(t3) {
            return t3 && t3.__esModule ? t3 : { default: t3 };
          };
          Object.defineProperty(r2, "__esModule", { value: true });
          var o = n(e2(7843));
          function s(t3, r3) {
            if (!Array.isArray(t3))
              return true === i(t3, r3);
            var e3, n2, o2, f2, p = t3[0];
            switch (p) {
              case "!":
                return !s(t3[1], r3);
              case "or":
                for (var l = 1; l < t3.length; l++)
                  if (s(t3[l], r3))
                    return true;
                return false;
              case "and":
                for (l = 1; l < t3.length; l++)
                  if (!s(t3[l], r3))
                    return false;
                return true;
              case "=":
              case "!=":
                return function(t4, r4, e4, n3) {
                  switch (u(t4) && (t4 = s(t4, n3)), u(r4) && (r4 = s(r4, n3)), "object" == typeof t4 && "object" == typeof r4 && (t4 = JSON.stringify(t4), r4 = JSON.stringify(r4)), e4) {
                    case "=":
                      return t4 === r4;
                    case "!=":
                      return t4 !== r4;
                    default:
                      throw new Error("Invalid operator in compareItems: ".concat(e4));
                  }
                }(i(t3[1], r3), i(t3[2], r3), p, r3);
              case "<=":
              case "<":
              case ">":
              case ">=":
                return function(t4, r4, e4, n3) {
                  if (u(t4) && (t4 = s(t4, n3)), u(r4) && (r4 = s(r4, n3)), "number" != typeof t4 || "number" != typeof r4)
                    return false;
                  switch (e4) {
                    case "<=":
                      return t4 <= r4;
                    case ">=":
                      return t4 >= r4;
                    case "<":
                      return t4 < r4;
                    case ">":
                      return t4 > r4;
                    default:
                      throw new Error("Invalid operator in compareNumbers: ".concat(e4));
                  }
                }(i(t3[1], r3), i(t3[2], r3), p, r3);
              case "in":
                return function(t4, r4, e4) {
                  return void 0 !== r4.find(function(r5) {
                    return i(r5, e4) === t4;
                  });
                }(i(t3[1], r3), i(t3[2], r3), r3);
              case "contains":
                return o2 = i(t3[1], r3), f2 = i(t3[2], r3), "string" == typeof o2 && "string" == typeof f2 && -1 !== o2.indexOf(f2);
              case "match":
                return e3 = i(t3[1], r3), n2 = i(t3[2], r3), "string" == typeof e3 && "string" == typeof n2 && function(t4, r4) {
                  var e4, n3;
                  t: for (; t4.length > 0; ) {
                    var o3, s2;
                    if (o3 = (e4 = a(t4)).star, s2 = e4.chunk, t4 = e4.pattern, o3 && "" === s2)
                      return true;
                    var i2 = c(s2, r4), u2 = i2.t, f3 = i2.ok, p2 = i2.err;
                    if (p2)
                      return false;
                    if (!f3 || !(0 === u2.length || t4.length > 0)) {
                      if (o3)
                        for (var l2 = 0; l2 < r4.length; l2++) {
                          if (u2 = (n3 = c(s2, r4.slice(l2 + 1))).t, f3 = n3.ok, p2 = n3.err, f3) {
                            if (0 === t4.length && u2.length > 0)
                              continue;
                            r4 = u2;
                            continue t;
                          }
                          if (p2)
                            return false;
                        }
                      return false;
                    }
                    r4 = u2;
                  }
                  return 0 === r4.length;
                }(n2, e3);
              case "lowercase":
                var v = i(t3[1], r3);
                return "string" != typeof v ? null : v.toLowerCase();
              case "typeof":
                return typeof i(t3[1], r3);
              case "length":
                return function(t4) {
                  return null === t4 ? 0 : Array.isArray(t4) || "string" == typeof t4 ? t4.length : NaN;
                }(i(t3[1], r3));
              default:
                throw new Error("FQL IR could not evaluate for token: ".concat(p));
            }
          }
          function i(t3, r3) {
            return Array.isArray(t3) ? t3 : "object" == typeof t3 ? t3.value : (0, o.default)(r3, t3);
          }
          function u(t3) {
            return !!Array.isArray(t3) && (("lowercase" === t3[0] || "length" === t3[0] || "typeof" === t3[0]) && 2 === t3.length || ("contains" === t3[0] || "match" === t3[0]) && 3 === t3.length);
          }
          function a(t3) {
            for (var r3 = { star: false, chunk: "", pattern: "" }; t3.length > 0 && "*" === t3[0]; )
              t3 = t3.slice(1), r3.star = true;
            var e3, n2 = false;
            t: for (e3 = 0; e3 < t3.length; e3++)
              switch (t3[e3]) {
                case "\\":
                  e3 + 1 < t3.length && e3++;
                  break;
                case "[":
                  n2 = true;
                  break;
                case "]":
                  n2 = false;
                  break;
                case "*":
                  if (!n2)
                    break t;
              }
            return r3.chunk = t3.slice(0, e3), r3.pattern = t3.slice(e3), r3;
          }
          function c(t3, r3) {
            for (var e3, n2, o2 = { t: "", ok: false, err: false }; t3.length > 0; ) {
              if (0 === r3.length)
                return o2;
              switch (t3[0]) {
                case "[":
                  var s2 = r3[0];
                  r3 = r3.slice(1);
                  var i2 = true;
                  (t3 = t3.slice(1)).length > 0 && "^" === t3[0] && (i2 = false, t3 = t3.slice(1));
                  for (var u2 = false, a2 = 0; ; ) {
                    if (t3.length > 0 && "]" === t3[0] && a2 > 0) {
                      t3 = t3.slice(1);
                      break;
                    }
                    var c2, p = "";
                    if (c2 = (e3 = f(t3)).char, t3 = e3.newChunk, e3.err)
                      return o2;
                    if (p = c2, "-" === t3[0] && (p = (n2 = f(t3.slice(1))).char, t3 = n2.newChunk, n2.err))
                      return o2;
                    c2 <= s2 && s2 <= p && (u2 = true), a2++;
                  }
                  if (u2 !== i2)
                    return o2;
                  break;
                case "?":
                  r3 = r3.slice(1), t3 = t3.slice(1);
                  break;
                case "\\":
                  if (0 === (t3 = t3.slice(1)).length)
                    return o2.err = true, o2;
                default:
                  if (t3[0] !== r3[0])
                    return o2;
                  r3 = r3.slice(1), t3 = t3.slice(1);
              }
            }
            return o2.t = r3, o2.ok = true, o2.err = false, o2;
          }
          function f(t3) {
            var r3 = { char: "", newChunk: "", err: false };
            return 0 === t3.length || "-" === t3[0] || "]" === t3[0] || "\\" === t3[0] && 0 === (t3 = t3.slice(1)).length ? (r3.err = true, r3) : (r3.char = t3[0], r3.newChunk = t3.slice(1), 0 === r3.newChunk.length && (r3.err = true), r3);
          }
          r2.default = function(t3, r3) {
            if (!r3)
              throw new Error("No matcher supplied!");
            switch (r3.type) {
              case "all":
                return true;
              case "fql":
                return function(t4, r4) {
                  if (!t4)
                    return false;
                  try {
                    t4 = JSON.parse(t4);
                  } catch (r5) {
                    throw new Error('Failed to JSON.parse FQL intermediate representation "'.concat(t4, '": ').concat(r5));
                  }
                  var e3 = s(t4, r4);
                  return "boolean" == typeof e3 && e3;
                }(r3.ir, t3);
              default:
                throw new Error("Matcher of type ".concat(r3.type, " unsupported."));
            }
          };
        }, 1444: function(t2, r2) {
          "use strict";
          Object.defineProperty(r2, "__esModule", { value: true });
          var e2 = function() {
            function t3(t4) {
              this.rules = [], this.rules = t4 || [];
            }
            return t3.prototype.getRulesByDestinationName = function(t4) {
              for (var r3 = [], e3 = 0, n = this.rules; e3 < n.length; e3++) {
                var o = n[e3];
                o.destinationName !== t4 && void 0 !== o.destinationName || r3.push(o);
              }
              return r3;
            }, t3;
          }();
          r2.default = e2;
        }, 4303: function(t2, r2, e2) {
          "use strict";
          var n = this && this.__importDefault || function(t3) {
            return t3 && t3.__esModule ? t3 : { default: t3 };
          };
          Object.defineProperty(r2, "__esModule", { value: true });
          var o = n(e2(374)), s = n(e2(7843)), i = n(e2(5500)), u = e2(9014), a = e2(4966);
          function c(t3, r3) {
            p(t3, r3.drop, function(t4, r4) {
              r4.forEach(function(r5) {
                return delete t4[r5];
              });
            });
          }
          function f(t3, r3) {
            p(t3, r3.allow, function(t4, r4) {
              Object.keys(t4).forEach(function(e3) {
                r4.includes(e3) || delete t4[e3];
              });
            });
          }
          function p(t3, r3, e3) {
            Object.entries(r3).forEach(function(r4) {
              var n2 = r4[0], o2 = r4[1], i2 = function(t4) {
                "object" == typeof t4 && null !== t4 && e3(t4, o2);
              }, u2 = "" === n2 ? t3 : (0, s.default)(t3, n2);
              Array.isArray(u2) ? u2.forEach(i2) : i2(u2);
            });
          }
          function l(t3, r3) {
            var e3 = JSON.parse(JSON.stringify(t3));
            for (var n2 in r3.map)
              if (r3.map.hasOwnProperty(n2)) {
                var o2 = r3.map[n2], i2 = n2.split("."), c2 = void 0;
                if (i2.length > 1 ? (i2.pop(), c2 = (0, s.default)(e3, i2.join("."))) : c2 = t3, "object" == typeof c2) {
                  if (o2.copy) {
                    var f2 = (0, s.default)(e3, o2.copy);
                    void 0 !== f2 && (0, u.dset)(t3, n2, f2);
                  } else if (o2.move) {
                    var p2 = (0, s.default)(e3, o2.move);
                    void 0 !== p2 && (0, u.dset)(t3, n2, p2), (0, a.unset)(t3, o2.move);
                  } else
                    o2.hasOwnProperty("set") && (0, u.dset)(t3, n2, o2.set);
                  if (o2.to_string) {
                    var l2 = (0, s.default)(t3, n2);
                    if ("string" == typeof l2 || "object" == typeof l2 && null !== l2)
                      continue;
                    void 0 !== l2 ? (0, u.dset)(t3, n2, JSON.stringify(l2)) : (0, u.dset)(t3, n2, "undefined");
                  }
                }
              }
          }
          function v(t3, r3) {
            return !(r3.sample.percent <= 0) && (r3.sample.percent >= 1 || (r3.sample.path ? function(t4, r4) {
              var e4 = (0, s.default)(t4, r4.sample.path), n2 = (0, o.default)(JSON.stringify(e4)), u2 = -64, a2 = [];
              y(n2.slice(0, 8), a2);
              for (var c2 = 0, f2 = 0; f2 < 64 && 1 !== a2[f2]; f2++)
                c2++;
              if (0 !== c2) {
                var p2 = [];
                y(n2.slice(9, 16), p2), u2 -= c2, a2.splice(0, c2), p2.splice(64 - c2), a2 = a2.concat(p2);
              }
              return a2[63] = 0 === a2[63] ? 1 : 0, (0, i.default)(parseInt(a2.join(""), 2), u2) < r4.sample.percent;
            }(t3, r3) : (e3 = r3.sample.percent, Math.random() <= e3)));
            var e3;
          }
          function y(t3, r3) {
            for (var e3 = 0; e3 < 8; e3++)
              for (var n2 = t3[e3], o2 = 128; o2 >= 1; o2 /= 2)
                n2 - o2 >= 0 ? (n2 -= o2, r3.push(1)) : r3.push(0);
          }
          r2.default = function(t3, r3) {
            for (var e3 = t3, n2 = 0, o2 = r3; n2 < o2.length; n2++) {
              var s2 = o2[n2];
              switch (s2.type) {
                case "drop":
                  return null;
                case "drop_properties":
                  c(e3, s2.config);
                  break;
                case "allow_properties":
                  f(e3, s2.config);
                  break;
                case "sample_event":
                  if (v(e3, s2.config))
                    break;
                  return null;
                case "map_properties":
                  l(e3, s2.config);
                  break;
                case "hash_properties":
                  break;
                default:
                  throw new Error('Transformer of type "'.concat(s2.type, '" is unsupported.'));
              }
            }
            return e3;
          };
        }, 4966: function(t2, r2, e2) {
          "use strict";
          var n = this && this.__importDefault || function(t3) {
            return t3 && t3.__esModule ? t3 : { default: t3 };
          };
          Object.defineProperty(r2, "__esModule", { value: true }), r2.unset = void 0;
          var o = n(e2(7843));
          r2.unset = function(t3, r3) {
            if ((0, o.default)(t3, r3)) {
              for (var e3 = r3.split("."), n2 = e3.pop(); e3.length && "\\" === e3[e3.length - 1].slice(-1); )
                n2 = e3.pop().slice(0, -1) + "." + n2;
              for (; e3.length; )
                t3 = t3[r3 = e3.shift()];
              return delete t3[n2];
            }
            return true;
          };
        }, 9014: function(t2, r2) {
          r2.dset = function(t3, r3, e2) {
            r3.split && (r3 = r3.split("."));
            for (var n, o, s = 0, i = r3.length, u = t3; s < i && "__proto__" !== (o = r3[s++]) && "constructor" !== o && "prototype" !== o; )
              u = u[o] = s === i ? e2 : typeof (n = u[o]) == typeof r3 ? n : 0 * r3[s] != 0 || ~("" + r3[s]).indexOf(".") ? {} : [];
          };
        }, 3304: function(t2) {
          "use strict";
          var r2 = "function" == typeof Float64Array ? Float64Array : void 0;
          t2.exports = r2;
        }, 7382: function(t2, r2, e2) {
          "use strict";
          var n, o = e2(5569), s = e2(3304), i = e2(8482);
          n = o() ? s : i, t2.exports = n;
        }, 8482: function(t2) {
          "use strict";
          t2.exports = function() {
            throw new Error("not implemented");
          };
        }, 6322: function(t2, r2, e2) {
          "use strict";
          var n, o = e2(2508), s = e2(5679), i = e2(882);
          n = o() ? s : i, t2.exports = n;
        }, 882: function(t2) {
          "use strict";
          t2.exports = function() {
            throw new Error("not implemented");
          };
        }, 5679: function(t2) {
          "use strict";
          var r2 = "function" == typeof Uint16Array ? Uint16Array : void 0;
          t2.exports = r2;
        }, 4773: function(t2, r2, e2) {
          "use strict";
          var n, o = e2(9773), s = e2(3004), i = e2(3078);
          n = o() ? s : i, t2.exports = n;
        }, 3078: function(t2) {
          "use strict";
          t2.exports = function() {
            throw new Error("not implemented");
          };
        }, 3004: function(t2) {
          "use strict";
          var r2 = "function" == typeof Uint32Array ? Uint32Array : void 0;
          t2.exports = r2;
        }, 7980: function(t2, r2, e2) {
          "use strict";
          var n, o = e2(8114), s = e2(6737), i = e2(3357);
          n = o() ? s : i, t2.exports = n;
        }, 3357: function(t2) {
          "use strict";
          t2.exports = function() {
            throw new Error("not implemented");
          };
        }, 6737: function(t2) {
          "use strict";
          var r2 = "function" == typeof Uint8Array ? Uint8Array : void 0;
          t2.exports = r2;
        }, 2684: function(t2) {
          "use strict";
          var r2 = "function" == typeof Float64Array ? Float64Array : null;
          t2.exports = r2;
        }, 5569: function(t2, r2, e2) {
          "use strict";
          var n = e2(3876);
          t2.exports = n;
        }, 3876: function(t2, r2, e2) {
          "use strict";
          var n = e2(1448), o = e2(2684);
          t2.exports = function() {
            var t3, r3;
            if ("function" != typeof o)
              return false;
            try {
              r3 = new o([1, 3.14, -3.14, NaN]), t3 = n(r3) && 1 === r3[0] && 3.14 === r3[1] && -3.14 === r3[2] && r3[3] != r3[3];
            } catch (r4) {
              t3 = false;
            }
            return t3;
          };
        }, 9048: function(t2, r2, e2) {
          "use strict";
          var n = e2(3763);
          t2.exports = n;
        }, 3763: function(t2) {
          "use strict";
          var r2 = Object.prototype.hasOwnProperty;
          t2.exports = function(t3, e2) {
            return null != t3 && r2.call(t3, e2);
          };
        }, 7009: function(t2, r2, e2) {
          "use strict";
          var n = e2(6784);
          t2.exports = n;
        }, 6784: function(t2) {
          "use strict";
          t2.exports = function() {
            return "function" == typeof Symbol && "symbol" == typeof Symbol("foo");
          };
        }, 3123: function(t2, r2, e2) {
          "use strict";
          var n = e2(8481);
          t2.exports = n;
        }, 8481: function(t2, r2, e2) {
          "use strict";
          var n = e2(7009)();
          t2.exports = function() {
            return n && "symbol" == typeof Symbol.toStringTag;
          };
        }, 2508: function(t2, r2, e2) {
          "use strict";
          var n = e2(3403);
          t2.exports = n;
        }, 3403: function(t2, r2, e2) {
          "use strict";
          var n = e2(768), o = e2(9668), s = e2(187);
          t2.exports = function() {
            var t3, r3;
            if ("function" != typeof s)
              return false;
            try {
              r3 = new s(r3 = [1, 3.14, -3.14, o + 1, o + 2]), t3 = n(r3) && 1 === r3[0] && 3 === r3[1] && r3[2] === o - 2 && 0 === r3[3] && 1 === r3[4];
            } catch (r4) {
              t3 = false;
            }
            return t3;
          };
        }, 187: function(t2) {
          "use strict";
          var r2 = "function" == typeof Uint16Array ? Uint16Array : null;
          t2.exports = r2;
        }, 9773: function(t2, r2, e2) {
          "use strict";
          var n = e2(2822);
          t2.exports = n;
        }, 2822: function(t2, r2, e2) {
          "use strict";
          var n = e2(2744), o = e2(3899), s = e2(746);
          t2.exports = function() {
            var t3, r3;
            if ("function" != typeof s)
              return false;
            try {
              r3 = new s(r3 = [1, 3.14, -3.14, o + 1, o + 2]), t3 = n(r3) && 1 === r3[0] && 3 === r3[1] && r3[2] === o - 2 && 0 === r3[3] && 1 === r3[4];
            } catch (r4) {
              t3 = false;
            }
            return t3;
          };
        }, 746: function(t2) {
          "use strict";
          var r2 = "function" == typeof Uint32Array ? Uint32Array : null;
          t2.exports = r2;
        }, 8114: function(t2, r2, e2) {
          "use strict";
          var n = e2(8066);
          t2.exports = n;
        }, 8066: function(t2, r2, e2) {
          "use strict";
          var n = e2(8279), o = e2(3443), s = e2(2731);
          t2.exports = function() {
            var t3, r3;
            if ("function" != typeof s)
              return false;
            try {
              r3 = new s(r3 = [1, 3.14, -3.14, o + 1, o + 2]), t3 = n(r3) && 1 === r3[0] && 3 === r3[1] && r3[2] === o - 2 && 0 === r3[3] && 1 === r3[4];
            } catch (r4) {
              t3 = false;
            }
            return t3;
          };
        }, 2731: function(t2) {
          "use strict";
          var r2 = "function" == typeof Uint8Array ? Uint8Array : null;
          t2.exports = r2;
        }, 1448: function(t2, r2, e2) {
          "use strict";
          var n = e2(1453);
          t2.exports = n;
        }, 1453: function(t2, r2, e2) {
          "use strict";
          var n = e2(6208), o = "function" == typeof Float64Array;
          t2.exports = function(t3) {
            return o && t3 instanceof Float64Array || "[object Float64Array]" === n(t3);
          };
        }, 9331: function(t2, r2, e2) {
          "use strict";
          var n = e2(7980), o = { uint16: e2(6322), uint8: n };
          t2.exports = o;
        }, 5902: function(t2, r2, e2) {
          "use strict";
          var n = e2(4106);
          t2.exports = n;
        }, 4106: function(t2, r2, e2) {
          "use strict";
          var n, o, s = e2(9331);
          (o = new s.uint16(1))[0] = 4660, n = 52 === new s.uint8(o.buffer)[0], t2.exports = n;
        }, 768: function(t2, r2, e2) {
          "use strict";
          var n = e2(3823);
          t2.exports = n;
        }, 3823: function(t2, r2, e2) {
          "use strict";
          var n = e2(6208), o = "function" == typeof Uint16Array;
          t2.exports = function(t3) {
            return o && t3 instanceof Uint16Array || "[object Uint16Array]" === n(t3);
          };
        }, 2744: function(t2, r2, e2) {
          "use strict";
          var n = e2(2326);
          t2.exports = n;
        }, 2326: function(t2, r2, e2) {
          "use strict";
          var n = e2(6208), o = "function" == typeof Uint32Array;
          t2.exports = function(t3) {
            return o && t3 instanceof Uint32Array || "[object Uint32Array]" === n(t3);
          };
        }, 8279: function(t2, r2, e2) {
          "use strict";
          var n = e2(208);
          t2.exports = n;
        }, 208: function(t2, r2, e2) {
          "use strict";
          var n = e2(6208), o = "function" == typeof Uint8Array;
          t2.exports = function(t3) {
            return o && t3 instanceof Uint8Array || "[object Uint8Array]" === n(t3);
          };
        }, 6315: function(t2) {
          "use strict";
          t2.exports = 1023;
        }, 1686: function(t2) {
          "use strict";
          t2.exports = 2147483647;
        }, 3105: function(t2) {
          "use strict";
          t2.exports = 2146435072;
        }, 3449: function(t2) {
          "use strict";
          t2.exports = 2147483648;
        }, 6988: function(t2) {
          "use strict";
          t2.exports = -1023;
        }, 9777: function(t2) {
          "use strict";
          t2.exports = 1023;
        }, 3690: function(t2) {
          "use strict";
          t2.exports = -1074;
        }, 2918: function(t2, r2, e2) {
          "use strict";
          var n = e2(4772).NEGATIVE_INFINITY;
          t2.exports = n;
        }, 4165: function(t2) {
          "use strict";
          var r2 = Number.POSITIVE_INFINITY;
          t2.exports = r2;
        }, 6488: function(t2) {
          "use strict";
          t2.exports = 22250738585072014e-324;
        }, 9668: function(t2) {
          "use strict";
          t2.exports = 65535;
        }, 3899: function(t2) {
          "use strict";
          t2.exports = 4294967295;
        }, 3443: function(t2) {
          "use strict";
          t2.exports = 255;
        }, 7011: function(t2, r2, e2) {
          "use strict";
          var n = e2(812);
          t2.exports = n;
        }, 812: function(t2, r2, e2) {
          "use strict";
          var n = e2(4165), o = e2(2918);
          t2.exports = function(t3) {
            return t3 === n || t3 === o;
          };
        }, 1883: function(t2, r2, e2) {
          "use strict";
          var n = e2(1797);
          t2.exports = n;
        }, 1797: function(t2) {
          "use strict";
          t2.exports = function(t3) {
            return t3 != t3;
          };
        }, 513: function(t2, r2, e2) {
          "use strict";
          var n = e2(5760);
          t2.exports = n;
        }, 5760: function(t2) {
          "use strict";
          t2.exports = function(t3) {
            return Math.abs(t3);
          };
        }, 5848: function(t2, r2, e2) {
          "use strict";
          var n = e2(677);
          t2.exports = n;
        }, 677: function(t2, r2, e2) {
          "use strict";
          var n = e2(3449), o = e2(1686), s = e2(7838), i = e2(1921), u = e2(2490), a = [0, 0];
          t2.exports = function(t3, r3) {
            var e3, c;
            return s.assign(t3, a, 1, 0), e3 = a[0], e3 &= o, c = i(r3), u(e3 |= c &= n, a[1]);
          };
        }, 5500: function(t2, r2, e2) {
          "use strict";
          var n = e2(8397);
          t2.exports = n;
        }, 8397: function(t2, r2, e2) {
          "use strict";
          var n = e2(4165), o = e2(2918), s = e2(6315), i = e2(9777), u = e2(6988), a = e2(3690), c = e2(1883), f = e2(7011), p = e2(5848), l = e2(4948), v = e2(8478), y = e2(7838), d = e2(2490), h = [0, 0], x = [0, 0];
          t2.exports = function(t3, r3) {
            var e3, b;
            return 0 === t3 || c(t3) || f(t3) ? t3 : (l(h, t3), r3 += h[1], (r3 += v(t3 = h[0])) < a ? p(0, t3) : r3 > i ? t3 < 0 ? o : n : (r3 <= u ? (r3 += 52, b = 2220446049250313e-31) : b = 1, y(x, t3), e3 = x[0], e3 &= 2148532223, b * d(e3 |= r3 + s << 20, x[1])));
          };
        }, 4772: function(t2, r2, e2) {
          "use strict";
          var n = e2(7548);
          t2.exports = n;
        }, 7548: function(t2) {
          "use strict";
          t2.exports = Number;
        }, 8478: function(t2, r2, e2) {
          "use strict";
          var n = e2(4500);
          t2.exports = n;
        }, 4500: function(t2, r2, e2) {
          "use strict";
          var n = e2(1921), o = e2(3105), s = e2(6315);
          t2.exports = function(t3) {
            var r3 = n(t3);
            return (r3 = (r3 & o) >>> 20) - s | 0;
          };
        }, 2490: function(t2, r2, e2) {
          "use strict";
          var n = e2(9639);
          t2.exports = n;
        }, 4445: function(t2, r2, e2) {
          "use strict";
          var n, o, s;
          true === e2(5902) ? (o = 1, s = 0) : (o = 0, s = 1), n = { HIGH: o, LOW: s }, t2.exports = n;
        }, 9639: function(t2, r2, e2) {
          "use strict";
          var n = e2(4773), o = e2(7382), s = e2(4445), i = new o(1), u = new n(i.buffer), a = s.HIGH, c = s.LOW;
          t2.exports = function(t3, r3) {
            return u[a] = t3, u[c] = r3, i[0];
          };
        }, 5646: function(t2, r2, e2) {
          "use strict";
          var n;
          n = true === e2(5902) ? 1 : 0, t2.exports = n;
        }, 1921: function(t2, r2, e2) {
          "use strict";
          var n = e2(6285);
          t2.exports = n;
        }, 6285: function(t2, r2, e2) {
          "use strict";
          var n = e2(4773), o = e2(7382), s = e2(5646), i = new o(1), u = new n(i.buffer);
          t2.exports = function(t3) {
            return i[0] = t3, u[s];
          };
        }, 9024: function(t2, r2, e2) {
          "use strict";
          var n = e2(6488), o = e2(7011), s = e2(1883), i = e2(513);
          t2.exports = function(t3, r3, e3, u) {
            return s(t3) || o(t3) ? (r3[u] = t3, r3[u + e3] = 0, r3) : 0 !== t3 && i(t3) < n ? (r3[u] = 4503599627370496 * t3, r3[u + e3] = -52, r3) : (r3[u] = t3, r3[u + e3] = 0, r3);
          };
        }, 4948: function(t2, r2, e2) {
          "use strict";
          var n = e2(7576), o = e2(9422);
          n(o, "assign", e2(9024)), t2.exports = o;
        }, 9422: function(t2, r2, e2) {
          "use strict";
          var n = e2(9024);
          t2.exports = function(t3) {
            return n(t3, [0, 0], 1, 0);
          };
        }, 5239: function(t2, r2, e2) {
          "use strict";
          var n = e2(4773), o = e2(7382), s = e2(5782), i = new o(1), u = new n(i.buffer), a = s.HIGH, c = s.LOW;
          t2.exports = function(t3, r3, e3, n2) {
            return i[0] = t3, r3[n2] = u[a], r3[n2 + e3] = u[c], r3;
          };
        }, 7838: function(t2, r2, e2) {
          "use strict";
          var n = e2(7576), o = e2(4010);
          n(o, "assign", e2(5239)), t2.exports = o;
        }, 5782: function(t2, r2, e2) {
          "use strict";
          var n, o, s;
          true === e2(5902) ? (o = 1, s = 0) : (o = 0, s = 1), n = { HIGH: o, LOW: s }, t2.exports = n;
        }, 4010: function(t2, r2, e2) {
          "use strict";
          var n = e2(5239);
          t2.exports = function(t3) {
            return n(t3, [0, 0], 1, 0);
          };
        }, 7576: function(t2, r2, e2) {
          "use strict";
          var n = e2(7063);
          t2.exports = n;
        }, 7063: function(t2, r2, e2) {
          "use strict";
          var n = e2(6691);
          t2.exports = function(t3, r3, e3) {
            n(t3, r3, { configurable: false, enumerable: false, writable: false, value: e3 });
          };
        }, 2073: function(t2) {
          "use strict";
          var r2 = Object.defineProperty;
          t2.exports = r2;
        }, 1680: function(t2) {
          "use strict";
          var r2 = "function" == typeof Object.defineProperty ? Object.defineProperty : null;
          t2.exports = r2;
        }, 1471: function(t2, r2, e2) {
          "use strict";
          var n = e2(1680);
          t2.exports = function() {
            try {
              return n({}, "x", {}), true;
            } catch (t3) {
              return false;
            }
          };
        }, 6691: function(t2, r2, e2) {
          "use strict";
          var n, o = e2(1471), s = e2(2073), i = e2(1309);
          n = o() ? s : i, t2.exports = n;
        }, 1309: function(t2) {
          "use strict";
          var r2 = Object.prototype, e2 = r2.toString, n = r2.__defineGetter__, o = r2.__defineSetter__, s = r2.__lookupGetter__, i = r2.__lookupSetter__;
          t2.exports = function(t3, u, a) {
            var c, f, p, l;
            if ("object" != typeof t3 || null === t3 || "[object Array]" === e2.call(t3))
              throw new TypeError("invalid argument. First argument must be an object. Value: `" + t3 + "`.");
            if ("object" != typeof a || null === a || "[object Array]" === e2.call(a))
              throw new TypeError("invalid argument. Property descriptor must be an object. Value: `" + a + "`.");
            if ((f = "value" in a) && (s.call(t3, u) || i.call(t3, u) ? (c = t3.__proto__, t3.__proto__ = r2, delete t3[u], t3[u] = a.value, t3.__proto__ = c) : t3[u] = a.value), p = "get" in a, l = "set" in a, f && (p || l))
              throw new Error("invalid argument. Cannot specify one or more accessors and a value or writable attribute in the property descriptor.");
            return p && n && n.call(t3, u, a.get), l && o && o.call(t3, u, a.set), t3;
          };
        }, 6208: function(t2, r2, e2) {
          "use strict";
          var n, o = e2(3123), s = e2(7407), i = e2(4210);
          n = o() ? i : s, t2.exports = n;
        }, 7407: function(t2, r2, e2) {
          "use strict";
          var n = e2(173);
          t2.exports = function(t3) {
            return n.call(t3);
          };
        }, 4210: function(t2, r2, e2) {
          "use strict";
          var n = e2(9048), o = e2(1403), s = e2(173);
          t2.exports = function(t3) {
            var r3, e3, i;
            if (null == t3)
              return s.call(t3);
            e3 = t3[o], r3 = n(t3, o);
            try {
              t3[o] = void 0;
            } catch (r4) {
              return s.call(t3);
            }
            return i = s.call(t3), r3 ? t3[o] = e3 : delete t3[o], i;
          };
        }, 173: function(t2) {
          "use strict";
          var r2 = Object.prototype.toString;
          t2.exports = r2;
        }, 1403: function(t2) {
          "use strict";
          var r2 = "function" == typeof Symbol ? Symbol.toStringTag : "";
          t2.exports = r2;
        }, 7843: function(t2) {
          t2.exports = function(t3, r2, e2, n, o) {
            for (r2 = r2.split ? r2.split(".") : r2, n = 0; n < r2.length; n++)
              t3 = t3 ? t3[r2[n]] : o;
            return t3 === o ? e2 : t3;
          };
        }, 374: function(t2, r2, e2) {
          "use strict";
          e2.r(r2), e2.d(r2, { default: function() {
            return s;
          } });
          for (var n = [], o = 0; o < 64; )
            n[o] = 0 | 4294967296 * Math.sin(++o % Math.PI);
          function s(t3) {
            var r3, e3, s2, i = [r3 = 1732584193, e3 = 4023233417, ~r3, ~e3], u = [], a = unescape(encodeURI(t3)) + "", c = a.length;
            for (t3 = --c / 4 + 2 | 15, u[--t3] = 8 * c; ~c; )
              u[c >> 2] |= a.charCodeAt(c) << 8 * c--;
            for (o = a = 0; o < t3; o += 16) {
              for (c = i; a < 64; c = [s2 = c[3], r3 + ((s2 = c[0] + [r3 & e3 | ~r3 & s2, s2 & r3 | ~s2 & e3, r3 ^ e3 ^ s2, e3 ^ (r3 | ~s2)][c = a >> 4] + n[a] + ~~u[o | 15 & [a, 5 * a + 1, 3 * a + 5, 7 * a][c]]) << (c = [7, 12, 17, 22, 5, 9, 14, 20, 4, 11, 16, 23, 6, 10, 15, 21][4 * c + a++ % 4]) | s2 >>> -c), r3, e3])
                r3 = 0 | c[1], e3 = c[2];
              for (a = 4; a; )
                i[--a] += c[a];
            }
            for (t3 = ""; a < 32; )
              t3 += (i[a >> 3] >> 4 * (1 ^ a++) & 15).toString(16);
            return t3;
          }
        } }, r = {};
        function e(n) {
          var o = r[n];
          if (void 0 !== o)
            return o.exports;
          var s = r[n] = { exports: {} };
          return t[n].call(s.exports, s, s.exports, e), s.exports;
        }
        return e.d = function(t2, r2) {
          for (var n in r2)
            e.o(r2, n) && !e.o(t2, n) && Object.defineProperty(t2, n, { enumerable: true, get: r2[n] });
        }, e.o = function(t2, r2) {
          return Object.prototype.hasOwnProperty.call(t2, r2);
        }, e.r = function(t2) {
          "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t2, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(t2, "__esModule", { value: true });
        }, e(2870);
      }();
    });
  }
});

// node_modules/@segment/analytics-next/dist/pkg/plugins/routing-middleware/index.js
var tsub = __toESM(require_tsub());
var tsubMiddleware = function(rules) {
  return function(_a) {
    var payload = _a.payload, integration = _a.integration, next = _a.next;
    var store = new tsub.Store(rules);
    var rulesToApply = store.getRulesByDestinationName(integration);
    rulesToApply.forEach(function(rule) {
      var matchers = rule.matchers, transformers = rule.transformers;
      for (var i = 0; i < matchers.length; i++) {
        if (tsub.matches(payload.obj, matchers[i])) {
          payload.obj = tsub.transform(payload.obj, transformers[i]);
          if (payload.obj === null) {
            return next(null);
          }
        }
      }
    });
    next(payload);
  };
};
export {
  tsubMiddleware
};
/*! Bundled license information:

@segment/analytics-next/dist/pkg/vendor/tsub/tsub.js:
  (*! For license information please see tsub.js.LICENSE.txt *)
*/
//# sourceMappingURL=routing-middleware-R5NVTKQY.js.map
